version: 2

# this gets a unit test
models:
  - name: dim_date
    description: creates date dimension that braeks date inot months, weeeks, year, quarters, holiday fags, weekday, weekend.
    columns: 
      - name: date_id
        description: primary key for date dimension
        tests:
          - unique  
          - not_null
  - name: yr
    tests:
      - not_null


  # DATE contract
  - name: dim_date
    description: Date table that breaks out various components of the date from day to month and identifies US holidays, weekends and business days.
    config:
      contract:
        enforced: true
    columns:
      - name: date_day
        description: The actual date for any transaction.
        data_type: date
      - name: date_id
        description: Essentially the primary key, all date foreign keys will use this to join with. 
        data_type: number
      - name: yr
        description: The year as extracted from the date.
        data_type: number
      - name: quarter_of_yr
        description: The quarter of the year as calculated from the date.
        data_type: number
      - name: mth
        description: The month as extracted from the date.
        data_type: number
      - name: wk
        description: The week as extracted from the date.
        data_type: number
      - name: day_of_wk
        description: The day of the week as extracted from the date.
        data_type: number
      - name: day_name
        description: The name of the day in text as extracted from the numerical date.
        data_type: varchar
      - name: wk_of_yr
        description: The number of the week as extracted from the date.
        data_type: number
      - name: weekend_flag
        description: A flag calulcating the day as a weekend by using the number of the day 0-6.
        data_type: number
      - name: holiday_flag
        description: A flag that ideniotifes holidays based on the day and month of the year. For dynamic holidays such as Thanksgiving, the week, month and day name are used to reflect accurate holiday flags.
        data_type: number
      - name: refreshed_at
        description: last update date, generally this does not need an update. It is created for 10 years at a time.
        data_type: timestamp_ltz
